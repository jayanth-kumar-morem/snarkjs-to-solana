# CLI Documentation

The `@jayanth-kumar-morem/snarkjs-to-solana` package provides a command-line interface for converting snarkjs artifacts to Solana-compatible formats.

## Installation

### Global Installation (Recommended for CLI usage)
```bash
npm install -g @jayanth-kumar-morem/snarkjs-to-solana
```

### Local Installation
```bash
npm install @jayanth-kumar-morem/snarkjs-to-solana
```

If installed locally, you can run commands using `npx`:
```bash
npx snarkjs-to-solana verification-key-to-rust verification_key.json
```

## Commands

### verification-key-to-rust

Convert a snarkjs verification key JSON file to a Rust file compatible with Solana's groth16 verifier.

**Usage:**
```bash
snarkjs-to-solana verification-key-to-rust <verification-key-path> [options]
```

**Arguments:**
- `<verification-key-path>`: Path to the verification key JSON file generated by snarkjs

**Options:**
- `-o, --output <directory>`: Output directory (defaults to current directory)
- `-h, --help`: Display help for the command

**Examples:**
```bash
# Convert verification key to current directory
snarkjs-to-solana verification-key-to-rust verification_key.json

# Convert verification key to specific directory
snarkjs-to-solana verification-key-to-rust verification_key.json --output ./rust_files

# Short form
snarkjs-to-solana verification-key-to-rust verification_key.json -o ./rust_files
```

**Output:**
The command generates a `vote_verifying_key.rs` file containing:
- A Rust struct compatible with `groth16_solana::groth16::Groth16Verifyingkey`
- All verification key parameters properly formatted for Solana
- Ready-to-use constants for your Solana verification program

**Example Output Structure:**
```rust
use groth16_solana::groth16::Groth16Verifyingkey;

pub const VERIFYINGKEY: Groth16Verifyingkey = Groth16Verifyingkey {
    nr_pubinputs: 2,
    
    vk_alpha_g1: [
        // ... formatted alpha values
    ],
    
    vk_beta_g2: [
        // ... formatted beta values
    ],
    
    // ... other verification key parameters
};
```

## Error Handling

The CLI provides clear error messages for common issues:

- **File not found**: If the verification key file doesn't exist
- **Invalid JSON**: If the verification key file is not valid JSON
- **Parse errors**: If the verification key format is not compatible with ffjavascript
- **Permission errors**: If the output directory cannot be written to

## Integration with snarkjs Workflow

1. **Generate your circuit and verification key with snarkjs:**
   ```bash
   snarkjs groth16 setup circuit.r1cs powersOfTau28_hez_final_10.ptau circuit_0000.zkey
   snarkjs zkey export verificationkey circuit_0000.zkey verification_key.json
   ```

2. **Convert to Rust format:**
   ```bash
   snarkjs-to-solana verification-key-to-rust verification_key.json
   ```

3. **Use in your Solana program:**
   ```rust
   use groth16_solana::groth16::Groth16Verifyingkey;
   
   // Include the generated file
   mod vote_verifying_key;
   use vote_verifying_key::VERIFYINGKEY;
   
   // Use in verification
   groth16_solana::groth16::verify(&VERIFYINGKEY, &proof, &public_inputs)?;
   ```

## Troubleshooting

### Command not found
If you get "command not found" error:
1. Ensure the package is installed globally: `npm install -g @jayanth-kumar-morem/snarkjs-to-solana`
2. Or use with npx: `npx snarkjs-to-solana`

### Permission denied
If you get permission errors:
1. Check that you have write permissions to the output directory
2. Try specifying a different output directory with `-o`

### Invalid verification key format
Ensure your verification key was generated by snarkjs and follows the expected format:
```json
{
  "vk_alpha_1": [...],
  "vk_beta_2": [...],
  "vk_gamma_2": [...],
  "vk_delta_2": [...],
  "IC": [...]
}
``` 